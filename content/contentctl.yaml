version: 1.0

# General settings for the content
content:
  name: "Splunk Security Content"
  author: "Your Company Name"
  description: "Security detection rules, lookups, and macros for Splunk"

# Define the directory structure for your content
structure:
  detections: "detections"
  lookups: "lookups"
  macros: "macros"
  playbooks: "playbooks"
  tests: "tests"

# Validation settings
validation:
  required_fields:
    - name
    - description
    - search
    - tags
    - annotations
  detection_rule_format: "yaml"

# Deployment settings
deployment:
  splunk:
    server: "${{ secrets.SPLUNK_URL }}" # or set it here if you don't use GitHub secrets
    username: "${{ secrets.SPLUNK_USER }}"
    password: "${{ secrets.SPLUNK_PASS }}"
    app: "Splunk_TA_Security_Content"
    port: 8089

# Testing configuration
testing:
  test_cases_dir: "tests"
  output_format: "junit"

# Custom checks you want to apply during the validation process
custom_checks:
  - id: "check_rule_description"
    description: "Ensure all detection rules have a description."
    severity: "high"
    check: |
      if not rule.get('description'):
        return False
      return True

  - id: "check_rule_tags"
    description: "Ensure all detection rules have tags."
    severity: "medium"
    check: |
      if not rule.get('tags'):
        return False
      return True

# Reporting for validation and testing
reporting:
  output: "reports"
  format: "html"
